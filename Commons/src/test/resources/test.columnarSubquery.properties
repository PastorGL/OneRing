task.operations=select1,select2

task.input=source,sub1,sub2


input.path.source=spatial/track.tsv
ds.input.columns.source=userid,num,lat,lon,ts,type,prev,acc,_,_,_,_,pt,_,trackid

input.path.sub1=sub/1.tsv
ds.input.columns.sub1=_,type

input.path.sub2=sub/2.tsv
ds.input.columns.sub2=trackid,_


op.operation.select1=columnarToolbox
op.inputs.select1=source,sub1
op.definition.select1.query=SELECT userid,num FROM source WHERE type IN (SELECT type FROM sub1)
op.outputs.select1=ret1


op.operation.select2=columnarToolbox
op.inputs.select2=source,sub1,sub2
op.definition.select2.query=SELECT userid,num,acc FROM source WHERE acc >= 0 AND type NOT IN (SELECT type FROM sub1) OR trackid IN (SELECT trackid FROM sub2)
op.outputs.select2=ret2
