CREATE typed(@path='datasets/typed_output_u_*',@part_count=4);
TRANSFORM typed textToColumnar VALUE(userid,lat,lon,hour,minute,timestamp);

CREATE pois (@path='datasets/ots_assets');
TRANSFORM pois textToColumnar VALUE (location,name,type,azimuth,lat,lon,radius,viewing_angle);
TRANSFORM pois columnarToPoint(@lon.column=lon,@lat.column=lat,@radius.column=radius);

TRANSFORM typed columnarToTrack(
@userid.column=userid,
@lat.column=lat,
@lon.column=lon,
@ts.column=timestamp);

CALL eyeContact(
@angle.prop=viewing_angle,
@azimuth.prop=azimuth)
     INPUT pois FROM pois, tracks FROM typed OUTPUT result;
